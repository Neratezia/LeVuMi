<% subjects = Test.uniq.pluck(:subject) %>

<ul id="tabs" class="nav nav-tabs" role="tablist">
<% first = true %>
<% subjects.sort.each do |s| %>
      <li role="presentation" <% if first %> class="active" <%end %> ><a href="#<%= s%>" aria-controls="<%= s%>" role="tab" data-toggle="tab"><%= s%></a></li>
      <% first = false %>
<% end %>
</ul>

<div class="tab-content" style="border-left: 1px solid #e3e3e3; border-right: 1px solid #e3e3e3; border-bottom: 1px solid #e3e3e3; border-radius: 0 0 4px 4px; padding: 19px;">
  <% first = true %>
  <% subjects.sort.each do |s| %>
    <div role="tabpanel" class="tab-pane <% if first %>active<% end %>" id="<%= s%>">

      <% Test.where(:subject => s).find_each do |t| %>
          <div class="panel panel-default">
            <div class="panel-heading" role="tab" id="h<%=t.id%>">
              <h4 class="panel-title">
                <a role="button" data-toggle="collapse" href="#c<%=t.id%>" aria-expanded="false" aria-controls="c<%=t.id%>">
                  <%= t.name %>
                </a>
              </h4>
            </div>
            <div id="c<%=t.id%>" class="panel-collapse collapse" role="tabpanel" aria-labelledby="h<%=t.id%>">
              <div class="panel-body">
                <% if @login.isAdmin? %>
                    <p class="lead text-right">
                      <%= link_to edit_test_path(t), :title => "Bearbeiten", :data => {:remote => true} do %>
                          <span class="glyphicon glyphicon-pencil"></span>
                      <% end %>
                      <%= link_to test_path(t), :title => "LÃ¶schen", :method => :delete, :data => {:confirm => "Sind Sie sicher?"} do %>
                          <span class="glyphicon glyphicon-trash"></span>
                      <% end %>
                    </p>
                <% end %>

                <%= render(file: 'tests/_show', :locals =>  {:test => t})%>
              </div>
            </div>
          </div>
      <% end %>

    </div>
     <% first = false %>
  <% end %>
</div>

